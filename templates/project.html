{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Loyihalar" %}{% endblock %}

{% block content %}
<section class="text-white py-12 px-4 max-w-7xl mx-auto">
    <h2 class="text-center text-3xl font-bold mb-8">{% trans "Bizning loyihalarimiz" %}</h2>
    <p class="text-center text-lg font-bold mb-8">{% trans "Yaqinda ishga tushirilgan loyihalar" %}</p>

    <!-- Filtr tugmalari -->
    <div class="flex justify-center flex-wrap gap-4 mb-8">
        <button onclick="filterItems('all')" class="category-btn active-filter">
            {% trans "Barchasi" %}
        </button>
        <button onclick="filterItems('mobile_app')" class="category-btn">{% trans "Mobile app" %}</button>
        <button onclick="filterItems('crm')" class="category-btn">{% trans "CRM" %}</button>
        <button onclick="filterItems('web_site')" class="category-btn">{% trans "Web site" %}</button>
        <button onclick="filterItems('telegram_bot')" class="category-btn">{% trans "Telegram bot" %}</button>
        <button onclick="filterItems('web development')" class="category-btn">{% trans "Web Development" %}</button>
        <button onclick="filterItems('branding')" class="category-btn">{% trans "Branding" %}</button>
    </div>

    <!-- Loyihalar gridi -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 px-4" id="portfolioGrid">
        {% for project in projects %}
        <a href="{% url 'project_details' project.pk %}">
            <!-- Klass sifatida modeldagi type qiymati -->
            <div class="portfolio-item {{ project.proect_type.name }} relative group overflow-hidden rounded-lg bg-gray-800">
                {% if project.image %}
                <img src="{{ project.image.url }}" alt="{{ project.name }}" class="w-full h-[200px] object-cover">
                {% else %}
                <img src="{% static 'imgs/no-image.jpg' %}" alt="No image" class="w-full h-[200px] object-cover">
                {% endif %}
                <!-- Hoverda chiroyli nom chiqadi -->
                <div class="absolute inset-0 bg-black bg-opacity-80 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                   <span class="text-lg font-semibold">{{ project.proect_type.get_name_display }}</span>
                </div>
            </div>
        </a>
        {% empty %}
        <p class="text-center text-gray-400 col-span-3">{% trans "Hech qanday loyiha mavjud emas." %}</p>
        {% endfor %}
    </div>
</section>

<script>
function filterItems(filter) {
    const items = document.querySelectorAll('.portfolio-item');
    const buttons = document.querySelectorAll('.category-btn');

    // Faol tugmani yangilash
    buttons.forEach(btn => btn.classList.remove('active-filter'));
    const activeButton = Array.from(buttons).find(btn => btn.getAttribute('onclick') === `filterItems('${filter}')`);
    if (activeButton) {
        activeButton.classList.add('active-filter');
    }

    // Loyihalarni filtrlash
    items.forEach(item => {
        const itemClasses = Array.from(item.classList).map(cls => cls.toLowerCase());
        const isVisible = (
            filter === 'all' ||
            (filter === 'mobile_app' && itemClasses.includes('mobile_app')) ||
            (filter === 'crm' && itemClasses.includes('crm')) ||
            (filter === 'web_site' && itemClasses.includes('web_site')) ||
            (filter === 'telegram_bot' && itemClasses.includes('telegram_bot'))
        );

        item.style.display = isVisible ? 'block' : 'none';
    });
}

// Sahifa yuklanganda barcha loyihalarni koâ€˜rsatish
document.addEventListener('DOMContentLoaded', () => filterItems('all'));
</script>

<style>
.category-btn {
    margin-top: 1.5rem;
    border: 1px solid #1479C1;
    color: #1479C1;
    padding: 0.5rem 1.5rem;
    border-radius: 0.5rem;
    transition: background-color 0.3s, color 0.3s;
    cursor: pointer;
}
.category-btn:hover,
.category-btn.active-filter {
    background-color: #1479C1;
    color: white;
}
</style>
{% endblock %}
